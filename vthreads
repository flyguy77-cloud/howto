import java.util.ArrayList;
import java.util.List;

public class ChatSimulation {
  public static void main(String[] args) {
    ChatRoom chatRoom = new ChatRoom();

    int userCount = 100;
    int messagesPerUser = 5;

    List<Thread> threads = new ArrayList<>();

    for (int i = 1; i <= userCount; i++) {
      String userName = "User" + i;
      User user = new User(userName, chatRoom, messagesPerUser);

      Thread thread = Thread.startVirtualThread(user);
      threads.add(thread);
    }

    // Wacht op alle threads tot ze klaar zijn
    for (Thread thread : threads) {
      try {
        thread.join();
      } catch (InterruptedException e) {
        Thread.currentThread().interrupt();
        System.err.println("Main thread interrupted while waiting.");
      }
    }

    System.out.println("\n--- All messages in chatroom ---");
    chatRoom.displayMessages();
  }
}
